# 1.1.POST/api/v2/processo/enviar-documento-para-assinar

El objetivo del método es permitir a los Clientes, a través de la API, enviar procesos con uno o más documentos para firmar.

A diferencia de la aplicación ArqSign, que permite agrupar los archivos del proceso, en este servicio, al enviar el proceso con más de un documento, el servicio los considera como **una colección de archivos y no serán agrupados en un único archivo**. Es decir, no es posible agrupar archivos mediante el servicio de envío de procesos de documentos para firmar.

El usuario debe proporcionar los datos del proceso y de los destinatarios participantes en el proceso de firma.

## **Autenticaciones y permisos**

1. Para autenticarse en la API de ArqSign, el usuario debe proporcionar la AppKey válida de la cuenta que está enviando los documentos para firmas.
2. Solo las cuentas con **estado Activo** y con **permiso de Integración ArqSign** pueden enviar procesos mediante integración con ArqSign.
3. La cuenta debe contar con créditos de Envíos, SMS y/o WhatsApp, según la necesidad.
4. Si la cuenta no dispone de crédito, el sistema devuelve el mensaje:\
   &#xNAN;_"Saldo insuficiente de créditos de Envíos, WhatsApp o SMS."_

## **Solicitud: Parámetros**

**Orientaciones:**

Cuando el campo requerido sea “Sim” = Siempre requerido.

Cuando el campo requerido sea “Não” = Información Opcional.

Cuando el campo requerido sea “Talvez” = En algunos casos será requerido. Para conocer estos casos, consultar la descripción del tema según el número de referencia de la línea en la tabla.

Cuando el campo requerido sea “Não” = Información Opcional.

<figure><img src="../../../../../.gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

### Ejemplo de Body Request:

```
{
   "idResponsavel": "guid",
   "nomeProcesso": "varchar(250)",
    "idPasta": "guid",
    "configuracoesAvancadas": {
        "tempoExpiracaoDocumentoDias": "smallint",
        "avisoAntesExpiracaoDocumentoDias": "smallint",
        "frequenciaLembretesDias": "smallint",
        "gerarQrCode": "bit",
        "obrigarLeitura": "bit"
    },
    "renovacaoMeses": "tinyint",
    "mensagemPadrao": {
        "titulo": "varchar(150)",
        "texto": "varchar(max)"
    },
    "usarOrdemAssinatura": "bit",
    "usarPosicaoAssinaturaAutomatica": "bit",
    "destinatarios": [
        {
            "idTipoAcao": "tinyint",
            "ordemAssinatura": "tinyint",
            "nome": "varchar(150)",
            "email": "varchar(150)",
            "telefone": "varchar(20)",
            "assinarOnline": {
                "assinarComo": "tinyint",
                "papelPessoaFisica": [
                    "varchar(50)",
                    "varchar(50)",
                    "varchar(50)"
                ],
                "papelPessoaJuridica": [
                    "varchar(50)"
                ],
                "seguranca": {
                    "codigoSeguranca": "char(4)",
                    "idMeioEnvio": "tinyint",
                    "codigoSegurancaEmail": "varchar(150)",
                    "codigoSegurancaTelefone": "varchar(20)",
                    "reenviarCodigo": "bit"
                },
                "mensagemPersonalizada": {
                    "titulo": "VarChar(150)",
                    "texto": "VarChar(max)"
                },
                "anexos": [
                    {
                        "anexoDocumentoNome": "VarChar(75)",
                        "anexoObrigatorio": "bit",
                        "anexoExibirTodosDestinatarios": "bit"
                    }
                ],
                "definirPosicaoAssinaturaManual": [
                    {
                        "documentoDeOrdem": "tinyint",
                        "pessoaFisica": {
                            "pagina": "int",
                            "altura": "decimal",
                            "largura": "decimal",
                            "posicaoX": "decimal",
                            "posicaoY": "decimal"
                        },
                        "pessoaJuridica": {
                            "pagina": "int",
                            "altura": "decimal",
                            "largura": "decimal",
                            "posicaoX": "decimal",
                            "posicaoY": "decimal"
                        }
                    }

                ],
                "idTipoAssinatura": "tinyint",
                "assinaturaEletronica": {
                    "obrigarSignatarioInformarNome": "bit",
                    "obrigarSignatarioInformarNumeroDocumento": "bit",
                    "tipoDocumentoAInformar": "tinyint",
                    "configuracaoDocumentoOutro": {
                        "nomeDocumento": "VarChar(50)",
                        "formatoDadosDocumento": "tinyint",
                        "qtdeCaracteresDocumento": "tinyint"
                    },
                    "obrigarSignatarioInformarNomeEmpresa": "bit",
                    "obrigarSignatarioInformarNumeroDocumentoEmpresa": "bit",
                    "tipoDocumentoEmpresaAInformar": "tinyint",
                    "configuracaoDocumentoEmpresaOutro": {
                        "nomeDocumento": "VarChar(50)",
                        "formatoDadosDocumento": "tinyint",
                        "qtdeCaracteresDocumento": "tinyint"
                    }
                }
            }
        }
    ],
    "documentos": [//somente pdf
        {
            "ordemDocumento": "tinyint",
            "nomeComExtensao": "varchar(150)",
            "arquivo": "String Base64"
        },
        {
            "ordemDocumento": "tinyint",
            "nomeComExtensao": "varchar(150)",
            "arquivo": "String Base64"
        }
    ]
}
```

## **Descripción de los parámetros del JSON:**

### **idResponsavel**

Parámetro **obligatorio** que indica el ID del responsable del proceso. Esta información será considerada como el remitente del proceso. Si el usuario autenticado está relacionado con este ID, podrá visualizar todos los documentos en el menú "Enviados".\
Se debe proporcionar el ID de un usuario activo que pertenezca a la cuenta.

### **nomeProcesso**

Parámetro **obligatorio** que especifica el nombre del proceso, permitiendo hasta 250 caracteres.

### **idPasta**

Parámetro obligatorio que indica el ID de la carpeta del proceso.\
Se debe proporcionar un ID de carpeta que pertenezca a la cuenta.

### **configuracoesAvancada**

En esta sección del JSON, el usuario puede enviar configuraciones avanzadas para el proceso, como tiempo de expiración, aviso previo a la expiración, frecuencia de los avisos, generación de QRCode, y obligatoriedad de lectura de los documentos.

Estas configuraciones son **opcionales**. **Si no se envían** o se envían como nulas, el sistema u**sará las configuraciones predeterminadas de la cuenta**.

**tempoExpiracaoDocumentoDias**

Parámetro **opcional** que especifica el tiempo que el proceso estará disponible para firma, hasta que todos los signatarios firmen.\
Valores permitidos: entre {1} y {999}.

Si no se envía o se envía como nulo o 0, el sistema usará las configuraciones predeterminadas de la cuenta.

**avisoAntesExpiracaoDocumentoDias**

Parámetro opcional que define el tiempo antes de que el documento expire para que la aplicación comience a enviar avisos.\
Valores permitidos: entre {1} y {99}.

Si no se envía o se envía como nulo o 0, el sistema usará las configuraciones predeterminadas de la cuenta.

**frequenciaLembretesDias**

Parámetro **opcional** que especifica la frecuencia de los avisos de firma.\
Valores permitidos: entre {1} y {999}.\
Si no se envía o se envía como nulo o 0, el sistema usará las configuraciones predeterminadas de la cuenta.

**gerarQrCode**

Parámetro **opcional** que indica si se debe generar un QRCode del documento firmado al finalizar el proceso.\
Valores permitidos: 1 = true, 0 = false.\
Si no se envía o se envía como nulo o 0, el sistema usará las configuraciones predeterminadas de la cuenta.

**obrigarLeitura**

Parámetro **opcional** que establece si es obligatorio leer los documentos antes de firmarlos.\
Si el proceso tiene más de un documento, esta configuración obligará al signatario a abrir cada documento antes de habilitar el botón "Firmar".\
Valores permitidos: 1 = true, 0 = false.\
Si no se envía o se envía como nulo o 0, el sistema usará las configuraciones predeterminadas de la cuenta.

### **renovacaoMeses**

Parámetro **opcional** que indica el tiempo, en meses, para definir cuándo el proceso en cuestión necesita ser renovado.

### **mensagemPadrao**

Parámetro opcional que especifica el mensaje predeterminado que se enviará a todos los destinatarios definidos como firmantes del proceso.\
Si la colección de datos **"mensagemPadrao" no se envía**, el sistema utiliza los valores predeterminados:                                                                                                                                                 **Título=** ArqSign: \[Nombre del documento indicado en el parámetro "nome"]                                        **Texto=** Usted recibió el(los) documento(s): \[Nombre del documento indicado en el parámetro "nome"] para firmas.

**titulo**\
Parámetro **opcional** que especifica el título del mensaje que se enviará a los firmantes.

**texto**\
Parámetro **opcional** que especifica el texto del mensaje que se enviará a los firmantes.

### **usarOrdemAssinatura**

Parámetro **obligatorio** que indica si se usará o no un orden de firma para los firmantes.\
Valores permitidos: 1 = true, 0 = false.

a. Si el parámetro **usarOrdemAssinatura** se envía como **false**, el sistema ignora el valor del parámetro **"ordemAssinatura"** de todos los destinatarios con acción de Firmar Online y envía el proceso a todos los destinatarios con el orden 1.

b. Si el parámetro **usarOrdemAssinatura** se envía como **true**, el sistema valida el parámetro **"ordemAssinatura"** de todos los destinatarios con acción de Firmar Online. Es decir, el valor de **"ordemAssinatura"** no puede ser cero ni nulo.

En este caso, el sistema envía el proceso solo a los destinatarios con orden 1.

### **usarPosicaoAssinaturaAutomatica**

Parámetro **obligatorio** que indica si el proceso incluirá una página de firma al final de cada archivo, con la posición de las firmas asignada automáticamente.\
Valores permitidos: 1 = true, 0 = false.

a. Si el parámetro **usarPosicaoAssinaturaAutomatica** se envía como **true**, la aplicación **incluye una página al final de cada archivo con la posición de la firma asignada automáticamente**, según el tipo de firmante:

* **assinarComo = 1 (Persona física)**: Se incluye una página con la posición de firma automática para Persona Física (PF).
* **assinarComo = 2 (Persona jurídica)**: Se incluye una página con la posición de firma automática para Persona Jurídica (PJ).
* **assinarComo = 3 (Persona física y jurídica)**: Se incluye una página con posiciones de firma automática para ambos tipos (PF y PJ).

Cuando el parámetro **“usarPosicaoAssinaturaAutomatica”** se envíe como true, no es necesario enviar los parámetros **definirPosicaoAssinaturaManual**. Sin embargo, si en el JSON se incluye este parámetro para algún firmante, la información será ignorada en este caso.

b. Cuando el parámetro **usarPosicaoAssinaturaAutomatica** se envíe como **false**, significa que la ubicación de las firmas **para cada firmante** deberá ser informada manualmente **para cada archivo del proceso** en cuestión, siendo obligatorio enviar los datos del parámetro **definirPosicaoAssinaturaManual**.

{% hint style="danger" %}

{% endhint %}
